{"title":"Autocerrelaci√≥n espacial","markdown":{"yaml":{"title":"Autocerrelaci√≥n espacial","author":[{"name":"Manuel Sp√≠nola","url":"http://www.icomvis.una.ac.cr/index.php/manuel","affiliation":"ICOMVIS - UNA","affiliation-url":"http://www.icomvis.una.ac.cr/","orcid":"0000-0002-7839-1908"}],"format":{"html":{"embed-resources":true}},"date":"2025-06-09","toc":true,"toc-title":"Tabla de contenido","toc-location":"right","toc-depth":4,"execute":{"echo":false,"include":false},"citation":true,"bibliography":["references.bib","grateful-refs.bib"],"lang":"es","title-block-banner":"#f0f3f5","title-block-banner-color":"#0041C2"},"headingText":"üìç Introducci√≥n: Explorando la Autocorrelaci√≥n Espacial","containsRefs":false,"markdown":"\n\n```{r}\n#| message: false\n#| warning: false\nlibrary(tidyverse)\nlibrary(easystats)\nlibrary(sf)\nlibrary(sfdep)\nlibrary(patchwork)\nlibrary(gt)\nlibrary(gtExtras)\nlibrary(tibble)\nlibrary(grateful)\nlibrary(crgeo)\n```\n\n\n-   Cuando se analizan fen√≥menos geogr√°ficos ‚Äîcomo la distribuci√≥n de la pobreza, la incidencia de enfermedades o la calidad ambiental‚Äî es com√∫n preguntarse si los valores observados en una regi√≥n est√°n relacionados con los de sus regiones vecinas. Esta dependencia espacial se conoce como autocorrelaci√≥n espacial @fig-esquema-autocorrelacion.\n\n```{r}\n#| include: true\n#| out-width: 100%\n#| label: fig-esquema-autocorrelacion\n#| fig.cap: \"Ejemplos conceptuales de autocorrelaci√≥n espacial. La autocorrelaci√≥n positiva se observa cuando los valores similares (altos o bajos) est√°n agrupados espacialmente. La autocorrelaci√≥n negativa ocurre cuando valores dis√≠miles est√°n pr√≥ximos entre s√≠, generando un patr√≥n alternante. En ausencia de autocorrelaci√≥n, los valores se distribuyen de forma aleatoria en el espacio, sin patrones evidentes.\"\n\n# Crear una grilla simple con valores para cada patr√≥n\nmake_grid <- function(vals) {\n  expand.grid(x = 1:4, y = 4:1) %>%\n    mutate(value = vals)\n}\n\ngrid_pos <- make_grid(c(10,10,9,9,10,10,9,9,2,2,3,3,2,2,3,3))\ngrid_neg <- make_grid(c(10,2,10,2,2,10,2,10,10,2,10,2,2,10,2,10))\ngrid_rand <- make_grid(sample(1:10, 16, replace = TRUE))\n\nplot_pattern <- function(grid, title) {\n  ggplot(grid, aes(x, y, fill = value)) +\n    geom_tile(color = \"white\") +\n    scale_fill_viridis_c(option = \"C\") +\n    coord_fixed() +\n    labs(title = title) +\n    theme_void() +\n    theme(legend.position = \"none\")\n}\n\nlibrary(patchwork)\nplot_pattern(grid_pos, \"  Autocorrelaci√≥n positiva\") +\nplot_pattern(grid_neg, \"  Autocorrelaci√≥n negativa\") +\nplot_pattern(grid_rand, \"  Sin autocorrelaci√≥n\")\n```\n\n-   A diferencia de los an√°lisis estad√≠sticos tradicionales que asumen independencia entre observaciones, la autocorrelaci√≥n espacial permite detectar agrupamientos o patrones geogr√°ficos. Para este prop√≥sito, se utilizan herramientas como los **Indicadores Locales de Asociaci√≥n Espacial (LISA)**, que ayudan a identificar √°reas donde existen agrupamientos estad√≠sticamente significativos de valores altos o bajos.\n\n-   Uno de los LISA m√°s utilizados es el **estad√≠stico I de Moran local (√çndice de Moran)**, que permite cuantificar la autocorrelaci√≥n espacial para cada unidad geogr√°fica por separado. Este indicador clasifica los resultados en patrones como High-High (zonas con valores altos rodeadas de otras zonas altas), Low-Low, High-Low, Low-High, y sin asociaci√≥n significativa, permitiendo interpretar el comportamiento espacial de un fen√≥meno con mayor detalle.\n\n-   En este art√≠culo, aplico el estad√≠stico I de Moran local para analizar la distribuci√≥n espacial el √çndice de Pobreza Multidimensional a nivel cantonal en Costa Rica, que podr√≠a tener el objetivo de identificar patrones territoriales que puedan guiar decisiones informadas y pol√≠ticas p√∫blicas m√°s eficaces.\n\n```{r}\ncr <- cr_outline_c |>\n  st_transform(crs = 5367) |>\n  st_make_valid()\n```\n\n```{r}\ncr\n```\n\n```{r}\nc <- st_read(\"Cantones 84.json\", crs = 5367) |>\n  st_make_valid()\n```\n\n```{r}\nc <- st_intersection(c, cr)\n```\n\n```{r}\nipm <- data_read(\"indice_de_pobreza_multidimensional.xlsx\", sheet = 4)\n```\n\n```{r}\nipm$Cant√≥n\n```\n\n```{r}\nipm <- ipm |> separate_wider_delim(Cant√≥n, delim = \": \", names = c(\"id\", \"canton\")) |>\n  arrange(canton)\n```\n\n```{r}\nipm$canton\n```\n\n```{r}\nc <- c |> rename(canton = CANT√ìN) |>\n  arrange(canton)\n```\n\n```{r}\nc$canton\n```\n\n```{r}\nc <- left_join(c, ipm, by = \"canton\")\n```\n\n```{r}\nc\n```\n\n```{r}\nc <- c |>\n  select(canton, IPM, geometry)\n```\n\n```{r}\n#| include: true\n#| out-width: 100%\n#| label: fig-ipm\n#| fig.cap: \"Mapa del √çndice de Pobreza Multidimensional (IPM) en los cantones de Costa Rica para el a√±o 2023\"\nggplot() +\n  geom_sf(data = c, aes(fill = IPM)) +\n  scale_fill_viridis_c() +\n  theme_minimal() +\n  labs(title = \"√çndice de Pobreza Multidimensional por Cant√≥n en Costa Rica (2023)\", \n       fill = \"IPM\",\n       caption = \"Fuente: PNUD (2023), √çndice de pobreza multidimensional cantonal de Costa Rica.\")\n```\n\n```{r}\ngeo <- st_geometry(c)\n```\n\n```{r}\nnb <- st_contiguity(geo)\n```\n\n```{r}\nwt <- st_weights(nb)\n```\n\n```{r}\nst_nb_lag(nb, 2)\n```\n\n```{r}\nst_nb_lag_cumul(nb, 2)\n```\n\n```{r}\nc$IPM\n```\n\n```{r}\nh <- c %>%\n  mutate(nb = nb, wt = wt)\n```\n\n```{r}\nh\n```\n\n```{r}\nh |>\n  mutate(weighted_mean_lag = st_lag(c$IPM, nb, wt)) %>% \n  ggplot(aes(fill = weighted_mean_lag)) + \n  geom_sf(lwd = 0.2, color = \"black\") +\n  theme_void()\n```\n\n```{r}\nlisa <- h |>\n  mutate(moran = local_moran(IPM, nb, wt))\n```\n\n```{r}\nlisa$moran\n```\n\n```{r}\npull(lisa, moran)\n```\n\n## An√°lisis de Autocorrelaci√≥n Espacial seg√∫n el √çndie de Moran\n\n-   En un an√°lisis LISA (Local Indicators of Spatial Association) con el √çndice de Moran, las categor√≠as: High-High, Low-Low, High-Low y Low-High indican el tipo de agrupamiento espacial (cl√∫sters espaciales) entre los valores de la variable y los valores de las √°reas vecinas. Aqu√≠ te explico qu√© significa cada uno:\n\nüî¥ High-High (Alto-Alto)\n\n-   Una zona tiene un valor alto de la variable (por ejemplo, pobreza, criminalidad, etc.).\n\n-   Y est√° rodeada de otras zonas que tambi√©n tienen valores altos.\n\n-   üëâ Es un cluster significativo de valores altos.\n\n------------------------------------------------------------------------\n\nüîµ Low-Low (Bajo-Bajo)\n\n-   Una zona tiene un valor bajo, y est√° rodeada de zonas con valores bajos.\n\n-   üëâ Es un cluster significativo de valores bajos.\n\n------------------------------------------------------------------------\n\nüü° High-Low (Alto-Bajo)\n\n-   Una zona con valor alto, rodeada de zonas con valores bajos.\n\n-   üëâ Se interpreta como un outlier espacial o una zona at√≠pica.\n\n------------------------------------------------------------------------\n\nüü¢ Low-High (Bajo-Alto)\n\n-   Una zona con valor bajo, rodeada de zonas con valores altos.\n\n-   üëâ Tambi√©n es un outlier espacial.\n\n------------------------------------------------------------------------\n\n‚ö™ No significativo\n\n-   No hay evidencia estad√≠sticamente significativa de asociaci√≥n espacial.\n\n-   La zona no pertenece a ning√∫n cluster detectado.\n\n```{r}\n#| include: true\n#| label: tbl-descripcion-lisa\n#| tbl-cap: \"Descripci√≥n de los Cl√∫steres Espaciales seg√∫n el √çndice de Moran local\"\ntibble(\n  Cluster = c(\n    \"üî¥ High-High\", \n    \"üîµ Low-Low\", \n    \"üü° High-Low\", \n    \"üü¢ Low-High\", \n    \"‚ö™ No significativo\"\n  ),\n  Significado = c(\n    \"Zona con valores altos rodeada de otras zonas con valores altos (cl√∫ster positivo)\",\n    \"Zona con valores bajos rodeada de otras zonas con valores bajos (cl√∫ster positivo)\",\n    \"Zona con valores altos rodeada de zonas con valores bajos (outlier)\",\n    \"Zona con valores bajos rodeada de zonas con valores altos (outlier)\",\n    \"No se detecta un patr√≥n espacial significativo\"\n  )\n) |>\n  gt() |>\n  cols_label(\n    Cluster = \"Categor√≠a\",\n    Significado = \"Significado\"\n  ) |>\n  fmt_markdown(columns = everything())\n```\n\n```{r}\nlisa_colors <- c(\n  \"High-High\" = \"red2\",   # rojo fuerte\n  \"Low-Low\" = \"blue3\",     # azul fuerte\n  \"High-Low\" = \"yellow2\",    # naranja\n  \"Low-High\" = \"green3\",    # violeta\n  \"No significativo\" = \"grey90\"  # gris claro\n)\n```\n\n```{r}\n#| include: true\n#| out-width: 100%\n#| label: fig-lisa\n#| fig.cap: \"Mapa de autocorrelaci√≥n espacial del √çndice de Pobreza Multidimensional (IPM) por Cant√≥n en Costa Rica seg√∫n el √çndice de Mor√°n local.\"\nlisa |> \n  tidyr::unnest(moran) |> \n  ggplot(aes(fill = pysal)) +\n  geom_sf() +\n  geom_sf(lwd = 0.2, color = \"white\") +\n  theme_minimal() +\n  scale_fill_manual(values = lisa_colors, na.translate = FALSE) +\n  labs(fill = \"Autocorrelaci√≥n\\nLocal (LISA)\",\n       title = \"Mapa de Cl√∫steres Espaciales seg√∫n el I de Moran Local\")\n```\n\n-   High-high and low-low = spatial clusters\n\n-   High-low and low-high = spatial outliers\n\n## Cl√∫steres espaciales estad√≠sticamente significativos (p \\< 0.05) seg√∫n el √çndice de Moran\n\n```{r}\nlisa_unnested <- lisa |> unnest(moran)\n```\n\n```{r}\nlisa_unnested <- lisa_unnested |>\n  mutate(\n    cluster_sig = ifelse(p_ii_sim < 0.05, as.character(pysal), \"No Significativo\")\n  )\n```\n\n```{r}\n#| include: true\n#| out-width: 100%\n#| label: fig-lisa-clusters\n#| fig.cap: \"Mapa de Cl√∫steres del √çndice de Pobreza Multidimensional (IPM) por Cant√≥n en Costa Rica seg√∫n el √çndice de Moran local.\"\n\nggplot(lisa_unnested) +\n  geom_sf(aes(fill = cluster_sig)) +\n  scale_fill_manual(values = c(\n    \"High-High\" = \"red2\",\n    \"Low-Low\" = \"blue3\",\n    \"High-Low\" = \"yellow2\",\n    \"Low-High\" = \"green3\",\n    \"No Significativo\" = \"grey90\"\n  )) +\n  theme_minimal() +\n  labs(\n    fill = \"Tipo de Cluster \\nEspacial\"\n  )\n```\n\n```{r}\n#| include: true\n#| out-width: 100%\n#| label: tbl-lisa-ipm \n#| tbl-cap: \"Interpretaci√≥n de cl√∫steres espaciales seg√∫n el √çndice de Moran local para los valores de √çndice de Pobreza Multidimensional (IPM) en cantones de Costa Rica.\"\n# Crear la tabla de significado\ntabla_lisa <- tribble(\n  ~Cluster,      ~Significado,\n  \"üî¥ High-High\",   \"Zonas muy pobres rodeadas de otras zonas pobres\",\n  \"üîµ Low-Low\",     \"Zonas poco pobres rodeadas de otras zonas poco pobres\",\n  \"üü° High-Low\",    \"Zonas pobres rodeadas de zonas no pobres (outlier)\",\n  \"üü¢ Low-High\",    \"Zonas no pobres rodeadas de zonas pobres (outlier)\",\n  \"‚ö™ No significativo\",          \"Sin patr√≥n espacial claro\"\n)\n\n# Mostrar como tabla gt\ntabla_lisa |> \n  gt() |>\n  cols_label(\n    Cluster = \"Cl√∫ster\",\n    Significado = \"Interpretaci√≥n\"\n  ) |>\n  tab_style(\n    style = cell_text(weight = \"bold\"),\n    locations = cells_column_labels(everything())\n  )\n```\n\n-   Los cl√∫steres espaciales identificados por el √çndice de Moran local revelan patrones significativos en la distribuci√≥n del √çndice de Pobreza Multidimensional (IPM) en Costa Rica. Las zonas con valores altos de IPM tienden a agruparse en la regi√≥n Norte y Sureste del pa√≠s, lo que sugiere que la pobreza multidimensional no es un fen√≥meno aislado, sino que se manifiesta en √°reas espec√≠ficas del pa√≠s. Por otro lado, las zonas con valores bajos tambi√©n forman un cl√∫ster en la regi√≥n del Valle Central, indicando que hay regiones donde la pobreza multidimensional es menos prevalente.\n\n-   Para los gr√°ficos y an√°lisis us√© R version 4.5.0 [@base] y los siguientes paquetes de R: tidyverse v. 2.0.0 [@tidyverse], sfdep v. 0.2.5 [@sfdep], easystats v. 0.7.0 [@easystats], gt v. 0.8.2 [@gt] y sf v 1.0.21 [@sf2018]. Los datos del √çndice de Pobreza Multidimensional fueron obtenidos del Programa de las Naciones Unidas para el Desarrollo (PNUD) [@pnud2023ipm].\n\n```{r}\ncite_packages(output = \"paragraph\", out.dir = \".\")\n```\n","srcMarkdownNoYaml":"\n\n```{r}\n#| message: false\n#| warning: false\nlibrary(tidyverse)\nlibrary(easystats)\nlibrary(sf)\nlibrary(sfdep)\nlibrary(patchwork)\nlibrary(gt)\nlibrary(gtExtras)\nlibrary(tibble)\nlibrary(grateful)\nlibrary(crgeo)\n```\n\n# üìç Introducci√≥n: Explorando la Autocorrelaci√≥n Espacial\n\n-   Cuando se analizan fen√≥menos geogr√°ficos ‚Äîcomo la distribuci√≥n de la pobreza, la incidencia de enfermedades o la calidad ambiental‚Äî es com√∫n preguntarse si los valores observados en una regi√≥n est√°n relacionados con los de sus regiones vecinas. Esta dependencia espacial se conoce como autocorrelaci√≥n espacial @fig-esquema-autocorrelacion.\n\n```{r}\n#| include: true\n#| out-width: 100%\n#| label: fig-esquema-autocorrelacion\n#| fig.cap: \"Ejemplos conceptuales de autocorrelaci√≥n espacial. La autocorrelaci√≥n positiva se observa cuando los valores similares (altos o bajos) est√°n agrupados espacialmente. La autocorrelaci√≥n negativa ocurre cuando valores dis√≠miles est√°n pr√≥ximos entre s√≠, generando un patr√≥n alternante. En ausencia de autocorrelaci√≥n, los valores se distribuyen de forma aleatoria en el espacio, sin patrones evidentes.\"\n\n# Crear una grilla simple con valores para cada patr√≥n\nmake_grid <- function(vals) {\n  expand.grid(x = 1:4, y = 4:1) %>%\n    mutate(value = vals)\n}\n\ngrid_pos <- make_grid(c(10,10,9,9,10,10,9,9,2,2,3,3,2,2,3,3))\ngrid_neg <- make_grid(c(10,2,10,2,2,10,2,10,10,2,10,2,2,10,2,10))\ngrid_rand <- make_grid(sample(1:10, 16, replace = TRUE))\n\nplot_pattern <- function(grid, title) {\n  ggplot(grid, aes(x, y, fill = value)) +\n    geom_tile(color = \"white\") +\n    scale_fill_viridis_c(option = \"C\") +\n    coord_fixed() +\n    labs(title = title) +\n    theme_void() +\n    theme(legend.position = \"none\")\n}\n\nlibrary(patchwork)\nplot_pattern(grid_pos, \"  Autocorrelaci√≥n positiva\") +\nplot_pattern(grid_neg, \"  Autocorrelaci√≥n negativa\") +\nplot_pattern(grid_rand, \"  Sin autocorrelaci√≥n\")\n```\n\n-   A diferencia de los an√°lisis estad√≠sticos tradicionales que asumen independencia entre observaciones, la autocorrelaci√≥n espacial permite detectar agrupamientos o patrones geogr√°ficos. Para este prop√≥sito, se utilizan herramientas como los **Indicadores Locales de Asociaci√≥n Espacial (LISA)**, que ayudan a identificar √°reas donde existen agrupamientos estad√≠sticamente significativos de valores altos o bajos.\n\n-   Uno de los LISA m√°s utilizados es el **estad√≠stico I de Moran local (√çndice de Moran)**, que permite cuantificar la autocorrelaci√≥n espacial para cada unidad geogr√°fica por separado. Este indicador clasifica los resultados en patrones como High-High (zonas con valores altos rodeadas de otras zonas altas), Low-Low, High-Low, Low-High, y sin asociaci√≥n significativa, permitiendo interpretar el comportamiento espacial de un fen√≥meno con mayor detalle.\n\n-   En este art√≠culo, aplico el estad√≠stico I de Moran local para analizar la distribuci√≥n espacial el √çndice de Pobreza Multidimensional a nivel cantonal en Costa Rica, que podr√≠a tener el objetivo de identificar patrones territoriales que puedan guiar decisiones informadas y pol√≠ticas p√∫blicas m√°s eficaces.\n\n```{r}\ncr <- cr_outline_c |>\n  st_transform(crs = 5367) |>\n  st_make_valid()\n```\n\n```{r}\ncr\n```\n\n```{r}\nc <- st_read(\"Cantones 84.json\", crs = 5367) |>\n  st_make_valid()\n```\n\n```{r}\nc <- st_intersection(c, cr)\n```\n\n```{r}\nipm <- data_read(\"indice_de_pobreza_multidimensional.xlsx\", sheet = 4)\n```\n\n```{r}\nipm$Cant√≥n\n```\n\n```{r}\nipm <- ipm |> separate_wider_delim(Cant√≥n, delim = \": \", names = c(\"id\", \"canton\")) |>\n  arrange(canton)\n```\n\n```{r}\nipm$canton\n```\n\n```{r}\nc <- c |> rename(canton = CANT√ìN) |>\n  arrange(canton)\n```\n\n```{r}\nc$canton\n```\n\n```{r}\nc <- left_join(c, ipm, by = \"canton\")\n```\n\n```{r}\nc\n```\n\n```{r}\nc <- c |>\n  select(canton, IPM, geometry)\n```\n\n```{r}\n#| include: true\n#| out-width: 100%\n#| label: fig-ipm\n#| fig.cap: \"Mapa del √çndice de Pobreza Multidimensional (IPM) en los cantones de Costa Rica para el a√±o 2023\"\nggplot() +\n  geom_sf(data = c, aes(fill = IPM)) +\n  scale_fill_viridis_c() +\n  theme_minimal() +\n  labs(title = \"√çndice de Pobreza Multidimensional por Cant√≥n en Costa Rica (2023)\", \n       fill = \"IPM\",\n       caption = \"Fuente: PNUD (2023), √çndice de pobreza multidimensional cantonal de Costa Rica.\")\n```\n\n```{r}\ngeo <- st_geometry(c)\n```\n\n```{r}\nnb <- st_contiguity(geo)\n```\n\n```{r}\nwt <- st_weights(nb)\n```\n\n```{r}\nst_nb_lag(nb, 2)\n```\n\n```{r}\nst_nb_lag_cumul(nb, 2)\n```\n\n```{r}\nc$IPM\n```\n\n```{r}\nh <- c %>%\n  mutate(nb = nb, wt = wt)\n```\n\n```{r}\nh\n```\n\n```{r}\nh |>\n  mutate(weighted_mean_lag = st_lag(c$IPM, nb, wt)) %>% \n  ggplot(aes(fill = weighted_mean_lag)) + \n  geom_sf(lwd = 0.2, color = \"black\") +\n  theme_void()\n```\n\n```{r}\nlisa <- h |>\n  mutate(moran = local_moran(IPM, nb, wt))\n```\n\n```{r}\nlisa$moran\n```\n\n```{r}\npull(lisa, moran)\n```\n\n## An√°lisis de Autocorrelaci√≥n Espacial seg√∫n el √çndie de Moran\n\n-   En un an√°lisis LISA (Local Indicators of Spatial Association) con el √çndice de Moran, las categor√≠as: High-High, Low-Low, High-Low y Low-High indican el tipo de agrupamiento espacial (cl√∫sters espaciales) entre los valores de la variable y los valores de las √°reas vecinas. Aqu√≠ te explico qu√© significa cada uno:\n\nüî¥ High-High (Alto-Alto)\n\n-   Una zona tiene un valor alto de la variable (por ejemplo, pobreza, criminalidad, etc.).\n\n-   Y est√° rodeada de otras zonas que tambi√©n tienen valores altos.\n\n-   üëâ Es un cluster significativo de valores altos.\n\n------------------------------------------------------------------------\n\nüîµ Low-Low (Bajo-Bajo)\n\n-   Una zona tiene un valor bajo, y est√° rodeada de zonas con valores bajos.\n\n-   üëâ Es un cluster significativo de valores bajos.\n\n------------------------------------------------------------------------\n\nüü° High-Low (Alto-Bajo)\n\n-   Una zona con valor alto, rodeada de zonas con valores bajos.\n\n-   üëâ Se interpreta como un outlier espacial o una zona at√≠pica.\n\n------------------------------------------------------------------------\n\nüü¢ Low-High (Bajo-Alto)\n\n-   Una zona con valor bajo, rodeada de zonas con valores altos.\n\n-   üëâ Tambi√©n es un outlier espacial.\n\n------------------------------------------------------------------------\n\n‚ö™ No significativo\n\n-   No hay evidencia estad√≠sticamente significativa de asociaci√≥n espacial.\n\n-   La zona no pertenece a ning√∫n cluster detectado.\n\n```{r}\n#| include: true\n#| label: tbl-descripcion-lisa\n#| tbl-cap: \"Descripci√≥n de los Cl√∫steres Espaciales seg√∫n el √çndice de Moran local\"\ntibble(\n  Cluster = c(\n    \"üî¥ High-High\", \n    \"üîµ Low-Low\", \n    \"üü° High-Low\", \n    \"üü¢ Low-High\", \n    \"‚ö™ No significativo\"\n  ),\n  Significado = c(\n    \"Zona con valores altos rodeada de otras zonas con valores altos (cl√∫ster positivo)\",\n    \"Zona con valores bajos rodeada de otras zonas con valores bajos (cl√∫ster positivo)\",\n    \"Zona con valores altos rodeada de zonas con valores bajos (outlier)\",\n    \"Zona con valores bajos rodeada de zonas con valores altos (outlier)\",\n    \"No se detecta un patr√≥n espacial significativo\"\n  )\n) |>\n  gt() |>\n  cols_label(\n    Cluster = \"Categor√≠a\",\n    Significado = \"Significado\"\n  ) |>\n  fmt_markdown(columns = everything())\n```\n\n```{r}\nlisa_colors <- c(\n  \"High-High\" = \"red2\",   # rojo fuerte\n  \"Low-Low\" = \"blue3\",     # azul fuerte\n  \"High-Low\" = \"yellow2\",    # naranja\n  \"Low-High\" = \"green3\",    # violeta\n  \"No significativo\" = \"grey90\"  # gris claro\n)\n```\n\n```{r}\n#| include: true\n#| out-width: 100%\n#| label: fig-lisa\n#| fig.cap: \"Mapa de autocorrelaci√≥n espacial del √çndice de Pobreza Multidimensional (IPM) por Cant√≥n en Costa Rica seg√∫n el √çndice de Mor√°n local.\"\nlisa |> \n  tidyr::unnest(moran) |> \n  ggplot(aes(fill = pysal)) +\n  geom_sf() +\n  geom_sf(lwd = 0.2, color = \"white\") +\n  theme_minimal() +\n  scale_fill_manual(values = lisa_colors, na.translate = FALSE) +\n  labs(fill = \"Autocorrelaci√≥n\\nLocal (LISA)\",\n       title = \"Mapa de Cl√∫steres Espaciales seg√∫n el I de Moran Local\")\n```\n\n-   High-high and low-low = spatial clusters\n\n-   High-low and low-high = spatial outliers\n\n## Cl√∫steres espaciales estad√≠sticamente significativos (p \\< 0.05) seg√∫n el √çndice de Moran\n\n```{r}\nlisa_unnested <- lisa |> unnest(moran)\n```\n\n```{r}\nlisa_unnested <- lisa_unnested |>\n  mutate(\n    cluster_sig = ifelse(p_ii_sim < 0.05, as.character(pysal), \"No Significativo\")\n  )\n```\n\n```{r}\n#| include: true\n#| out-width: 100%\n#| label: fig-lisa-clusters\n#| fig.cap: \"Mapa de Cl√∫steres del √çndice de Pobreza Multidimensional (IPM) por Cant√≥n en Costa Rica seg√∫n el √çndice de Moran local.\"\n\nggplot(lisa_unnested) +\n  geom_sf(aes(fill = cluster_sig)) +\n  scale_fill_manual(values = c(\n    \"High-High\" = \"red2\",\n    \"Low-Low\" = \"blue3\",\n    \"High-Low\" = \"yellow2\",\n    \"Low-High\" = \"green3\",\n    \"No Significativo\" = \"grey90\"\n  )) +\n  theme_minimal() +\n  labs(\n    fill = \"Tipo de Cluster \\nEspacial\"\n  )\n```\n\n```{r}\n#| include: true\n#| out-width: 100%\n#| label: tbl-lisa-ipm \n#| tbl-cap: \"Interpretaci√≥n de cl√∫steres espaciales seg√∫n el √çndice de Moran local para los valores de √çndice de Pobreza Multidimensional (IPM) en cantones de Costa Rica.\"\n# Crear la tabla de significado\ntabla_lisa <- tribble(\n  ~Cluster,      ~Significado,\n  \"üî¥ High-High\",   \"Zonas muy pobres rodeadas de otras zonas pobres\",\n  \"üîµ Low-Low\",     \"Zonas poco pobres rodeadas de otras zonas poco pobres\",\n  \"üü° High-Low\",    \"Zonas pobres rodeadas de zonas no pobres (outlier)\",\n  \"üü¢ Low-High\",    \"Zonas no pobres rodeadas de zonas pobres (outlier)\",\n  \"‚ö™ No significativo\",          \"Sin patr√≥n espacial claro\"\n)\n\n# Mostrar como tabla gt\ntabla_lisa |> \n  gt() |>\n  cols_label(\n    Cluster = \"Cl√∫ster\",\n    Significado = \"Interpretaci√≥n\"\n  ) |>\n  tab_style(\n    style = cell_text(weight = \"bold\"),\n    locations = cells_column_labels(everything())\n  )\n```\n\n-   Los cl√∫steres espaciales identificados por el √çndice de Moran local revelan patrones significativos en la distribuci√≥n del √çndice de Pobreza Multidimensional (IPM) en Costa Rica. Las zonas con valores altos de IPM tienden a agruparse en la regi√≥n Norte y Sureste del pa√≠s, lo que sugiere que la pobreza multidimensional no es un fen√≥meno aislado, sino que se manifiesta en √°reas espec√≠ficas del pa√≠s. Por otro lado, las zonas con valores bajos tambi√©n forman un cl√∫ster en la regi√≥n del Valle Central, indicando que hay regiones donde la pobreza multidimensional es menos prevalente.\n\n-   Para los gr√°ficos y an√°lisis us√© R version 4.5.0 [@base] y los siguientes paquetes de R: tidyverse v. 2.0.0 [@tidyverse], sfdep v. 0.2.5 [@sfdep], easystats v. 0.7.0 [@easystats], gt v. 0.8.2 [@gt] y sf v 1.0.21 [@sf2018]. Los datos del √çndice de Pobreza Multidimensional fueron obtenidos del Programa de las Naciones Unidas para el Desarrollo (PNUD) [@pnud2023ipm].\n\n```{r}\ncite_packages(output = \"paragraph\", out.dir = \".\")\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":true,"include":false,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":4,"embed-resources":true,"output-file":"autocorrelacion_espacial.html"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta p√°gina","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de c√≥digo","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Art√≠culo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar c√≥digo fuente","notebook-preview-back":"Volver al Art√≠culo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Ap√©ndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilizaci√≥n","section-title-copyright":"Derechos de autor","section-title-citation":"C√≥mo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Ver Licencia","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliaci√≥n","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicaci√≥n","title-block-modified":"Fecha de √∫ltima modificaci√≥n","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precauci√≥n","code-summary":"C√≥digo","code-tools-menu-caption":"C√≥digo","code-tools-show-all-code":"Mostrar todo el c√≥digo","code-tools-hide-all-code":"Ocultar todo el c√≥digo","code-tools-view-source":"Ver el c√≥digo fuente","code-tools-source-code":"Ejecutar el c√≥digo","tools-share":"Compartir","tools-download":"Descargar","code-line":"L√≠nea","code-lines":"L√≠neas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta p√°gina","repo-action-links-source":"Ver el c√≥digo","repo-action-links-issue":"Informar sobre problema","back-to-top":"Volver arriba","search-no-results-text":"No se han encontrado resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la b√∫squeda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar secci√≥n","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegaci√≥n de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposici√≥n","crossref-cnj-title":"Conjetura","crossref-def-title":"Definici√≥n","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Cap√≠tulo","crossref-apx-prefix":"Ap√©ndice","crossref-sec-prefix":"Secci√≥n","crossref-eq-prefix":"Ecuaci√≥n","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Demostraci√≥n","environment-remark-title":"Observaci√≥n","environment-solution-title":"Soluci√≥n","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"M√°s antiguo","listing-page-order-by-date-desc":"M√°s reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"T√≠tulo","listing-page-field-description":"Descripci√≥n","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre del archivo","listing-page-field-filemodified":"√öltima modificaci√≥n","listing-page-field-subtitle":"Subt√≠tulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categor√≠as","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras","listing-page-filter":"Filtro","draft":"Borrador"},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.8.25","editor":"visual","theme":["cosmos","../../geobiolab_theme.scss"],"grid":{"sidebar-width":"300px","body-width":"900px","margin-width":"300px","gutter-width":"1.5rem"},"title":"Autocerrelaci√≥n espacial","author":[{"name":"Manuel Sp√≠nola","url":"http://www.icomvis.una.ac.cr/index.php/manuel","affiliation":"ICOMVIS - UNA","affiliation-url":"http://www.icomvis.una.ac.cr/","orcid":"0000-0002-7839-1908"}],"date":"2025-06-09","toc-title":"Tabla de contenido","toc-location":"right","citation":true,"bibliography":["references.bib","grateful-refs.bib"],"title-block-banner":"#f0f3f5","title-block-banner-color":"#0041C2"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}